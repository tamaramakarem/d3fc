<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Bubble Chart</title>
    <meta name="description" content="A collection of components that make it easy to build interactive charts with D3.">

    <script src="https://d3fc.io/lib/browser.js"></script>
    <script src="https://d3fc.io/lib/custom-event-polyfill.js"></script>
    <script src="https://d3fc.io/lib/d3.min.js"></script>
    <script src="https://d3fc.io/lib/jquery.min.js"></script>
    <script src="https://d3fc.io/lib/bootstrap.min.js"></script>
    <script src="https://d3fc.io/lib/d3fc.min.js"></script>
    <script src="https://d3fc.io/lib/d3-legend.min.js"></script>
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-96x96.png" sizes="96x96">
    <link rel="stylesheet" href="https://d3fc.io/styles.css" />
    <link rel="canonical" href="https://d3fc.io/examples/bubble/index.html" />
  </head>
  <body>
    <div class="content">

      <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <a href="https://d3fc.io/"><img class="navbar-logo" alt="d3fc" src="https://d3fc.io/images/logo.svg" /></a>
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="navbar-collapse collapse">
              <div class="floating-nav inverted">
                <ul class="nav navbar-nav">
                  <li class=""><a href="https://d3fc.io/introduction/getting-started.html">Documentation</a></li>
                  <li class="">
                    <a href="https://d3fc.io/api/annotation-api.html">API</a>
                  </li>
                  <li class="active">
                    <a href="https://d3fc.io/examples/bubble/">Examples</a>
                      <ul class="sub-nav">
                            <li class="sub-nav-item">
                              <a class="active" href="/examples/bubble/index.html">Bubble Chart</a>
                            </li>
                            <li class="sub-nav-item">
                              <a class="" href="/examples/simple/index.html">Line / Area Chart</a>
                            </li>
                            <li class="sub-nav-item">
                              <a class="" href="/examples/stacked/index.html">Stacked Bar</a>
                            </li>
                            <li class="sub-nav-item">
                              <a class="" href="/examples/streaming/index.html">Streaming Financial Chart</a>
                            </li>
                            <li class="sub-nav-item">
                              <a class="" href="/examples/zoom/index.html">Canvas Chart Zoom</a>
                            </li>
                      </ul>
                  </li>
                  <li><a href="https://github.com/d3fc/d3fc">GitHub</a></li>
                  <li class="separator"></li>
                </ul>
              </div>
            </div>
        </div>
      </nav>

      <div class="container content">
    <div class="col-sm-9 col-xs-12">
      <h1>
        Bubble Chart
      </h1>
      <style>
#bubble-chart .legend {
  position: absolute;
  bottom: 40px;
  right: 0;
  left: auto;
  width: 170px;
  height: 110px;
}

#bubble-chart {
  position: relative;
}

#bubble-chart .point {
  stroke: transparent;
}

#bubble-chart text.label {
  stroke: none;
  fill: #000;
  font: 12px sans-serif;
}

</style>

<div class="codepen-link">
  <form action="https://codepen.io/pen/define" method="POST" target="_blank">
    <input type="text" name="data" hidden="true"
      value='{
        "html":"&lt;div id&#x3D;\&quot;bubble-chart\&quot; class&#x3D;\&quot;chart large\&quot;&gt;Loading...&lt;/div&gt;\n",
        "js": "d3.json(\"https://d3fc.io/examples/bubble/data.json\", function(_, data) {\n  // convert string properties to numbers\n  data.forEach(function(d) {\n    d.income = Number(d.income);\n    d.population = Number(d.population);\n    d.lifeExpectancy = Number(d.lifeExpectancy);\n  });\n\n  var regions = d3.set(data.map(function(d) { return d.region; }));\n  var color = d3.scaleOrdinal(d3.schemeCategory10)\n    .domain(regions.values());\n\n  var legend = d3.legendColor()\n    .scale(color);\n\n  var size = d3.scaleLinear().range([20, 800])\n    .domain(fc.extentLinear()\n    .accessors([function(d) { return d.population; }])(data));\n\n  var pointSeries = fc.seriesSvgPoint()\n      .crossValue(function(d) { return d.income; })\n      .mainValue(function(d) { return d.lifeExpectancy; })\n      .size(function(d) { return size(d.population); })\n      .decorate(function(sel) {\n        sel.enter()\n            .attr(\"fill\", function(d) { return color(d.region); });\n      });\n\n  var chart = fc.chartSvgCartesian(\n                d3.scaleLog(),\n                d3.scaleLinear()\n              )\n      .xDomain(fc.extentLinear()\n        .accessors([function(d) { return d.income; }])(data))\n      .yDomain(fc.extentLinear()\n        .accessors([function(d) { return d.lifeExpectancy; }])(data))\n      .chartLabel(\"The Wealth & Health of Nations\")\n      .xLabel(\"Income (dollars)\")\n      .yLabel(\"Life expectancy (years)\")\n      .xTicks(2, d3.format(\",d\"))\n      .yOrient(\"left\")\n      .plotArea(pointSeries)\n      .decorate(function(selection) {\n        // append an svg for the d3-legend\n        selection.enter()\n          .append(\"svg\")\n          .attr(\"class\", \"legend\");\n\n        // render the legend\n        selection.select(\".legend\")\n          .call(legend);\n      });\n\n  d3.select(\"#bubble-chart\")\n      // remove the loading text from the container\n      .text(null)\n      .datum(data)\n      .call(chart);\n});\n",
        "css": ".chart-label {\n  font-size: 1.5em;\n  line-height: normal;\n  color: black;\n}\n\n.chart {\n  margin: 10px 0;\n  width: 100%;\n  height: 250px;\n}\n\n.chart svg {\n  overflow: visible !important;\n}\n\n.chart.large {\n  height: 400px;\n}\n\n.plot-area {\n  background-color: white;\n}\n\n.y-axis-label {\n  white-space: nowrap;\n}\n#bubble-chart .legend {\n  position: absolute;\n  bottom: 40px;\n  right: 0;\n  left: auto;\n  width: 170px;\n  height: 110px;\n}\n\n#bubble-chart {\n  position: relative;\n}\n\n#bubble-chart .point {\n  stroke: transparent;\n}\n\n#bubble-chart text.label {\n  stroke: none;\n  fill: #000;\n  font: 12px sans-serif;\n}\n",
        "js_external": "https://code.jquery.com/jquery-3.1.1.slim.min.js;https://d3js.org/d3.v4.js;https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.18.0/d3-legend.js;https://d3fc.io/lib/d3fc.min.js"
      }'/>
    <input type="submit" class="btn btn-default" value="Codepen"/>
  </form>
</div>

<div id='bubble-chart' class='chart large'>Loading...</div>

<script type="text/javascript">
    (function() {
        d3.json('https://d3fc.io/examples/bubble/data.json', function(_, data) {
  // convert string properties to numbers
  data.forEach(function(d) {
    d.income = Number(d.income);
    d.population = Number(d.population);
    d.lifeExpectancy = Number(d.lifeExpectancy);
  });

  var regions = d3.set(data.map(function(d) { return d.region; }));
  var color = d3.scaleOrdinal(d3.schemeCategory10)
    .domain(regions.values());

  var legend = d3.legendColor()
    .scale(color);

  var size = d3.scaleLinear().range([20, 800])
    .domain(fc.extentLinear()
    .accessors([function(d) { return d.population; }])(data));

  var pointSeries = fc.seriesSvgPoint()
      .crossValue(function(d) { return d.income; })
      .mainValue(function(d) { return d.lifeExpectancy; })
      .size(function(d) { return size(d.population); })
      .decorate(function(sel) {
        sel.enter()
            .attr('fill', function(d) { return color(d.region); });
      });

  var chart = fc.chartSvgCartesian(
                d3.scaleLog(),
                d3.scaleLinear()
              )
      .xDomain(fc.extentLinear()
        .accessors([function(d) { return d.income; }])(data))
      .yDomain(fc.extentLinear()
        .accessors([function(d) { return d.lifeExpectancy; }])(data))
      .chartLabel('The Wealth & Health of Nations')
      .xLabel('Income (dollars)')
      .yLabel('Life expectancy (years)')
      .xTicks(2, d3.format(',d'))
      .yOrient('left')
      .plotArea(pointSeries)
      .decorate(function(selection) {
        // append an svg for the d3-legend
        selection.enter()
          .append('svg')
          .attr('class', 'legend');

        // render the legend
        selection.select('.legend')
          .call(legend);
      });

  d3.select('#bubble-chart')
      // remove the loading text from the container
      .text(null)
      .datum(data)
      .call(chart);
});

    })();
</script>


<p>This example demonstrates how to render a bubble chart with data that shows the relationship between life expectancy and wealth, obtained via  <a href="http://www.gapminder.org/world/#$majorMode=chart$is;shi=t;ly=2003;lb=f;il=t;fs=11;al=30;stl=t;st=t;nsl=t;se=t$wst;tts=C$ts;sp=5.59290322580644;ti=2013$zpv;v=0$inc_x;mmid=XCOORDS;iid=phAwcNAVuyj1jiMAkmq1iMg;by=ind$inc_y;mmid=YCOORDS;iid=phAwcNAVuyj2tPLxKvvnNPA;by=ind$inc_s;uniValue=8.21;iid=phAwcNAVuyj0XOoBL_n5tAQ;by=ind$inc_c;uniValue=255;gid=CATID0;by=grp$map_x;scale=log;dataMin=194;dataMax=96846$map_y;scale=lin;dataMin=23;dataMax=86$map_s;sma=49;smi=2.65$cd;bd=0$inds=;modified=60">Gapminder</a>. The chart is constructed from the following components:</p>
<ul>
<li>The <code>d3.json</code> component is used to load the data from a JSON file.</li>
<li>A <a href="/api/chart-api.html">Cartesian chart</a>, with a logarithmic x scale and linear y scale, is used to render the plot area, axes and labels.</li>
<li>A <a href="/api/series-api.html#point">point series</a> is used to render the data, with the <code>size</code> of each point defined via another linear scale.</li>
<li>The <a href="/introduction/decorate-pattern.html">decorate pattern</a> is used to add a legend (courtesy of the <a href="http://d3-legend.susielu.com">d3-legend</a> project).</li>
</ul>
<pre><code class="lang-js">d3.json(<span class="hljs-string">'https://d3fc.io/examples/bubble/data.json'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_, data</span>) </span>{
  <span class="hljs-comment">// convert string properties to numbers</span>
  data.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{
    d.income = <span class="hljs-built_in">Number</span>(d.income);
    d.population = <span class="hljs-built_in">Number</span>(d.population);
    d.lifeExpectancy = <span class="hljs-built_in">Number</span>(d.lifeExpectancy);
  });

  <span class="hljs-built_in">var</span> regions = d3.set(data.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.region; }));
  <span class="hljs-built_in">var</span> <span class="hljs-built_in">color</span> = d3.scaleOrdinal(d3.schemeCategory10)
    .domain(regions.values());

  <span class="hljs-built_in">var</span> legend = d3.legendColor()
    .scale(<span class="hljs-built_in">color</span>);

  <span class="hljs-built_in">var</span> <span class="hljs-built_in">size</span> = d3.scaleLinear().range([<span class="hljs-number">20</span>, <span class="hljs-number">800</span>])
    .domain(fc.extentLinear()
    .accessors([<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.population; }])(data));

  <span class="hljs-built_in">var</span> pointSeries = fc.seriesSvgPoint()
      .crossValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.income; })
      .mainValue(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.lifeExpectancy; })
      .size(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">size</span>(d.population); })
      .decorate(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sel</span>) </span>{
        sel.enter()
            .attr(<span class="hljs-string">'fill'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">color</span>(d.region); });
      });

  <span class="hljs-built_in">var</span> chart = fc.chartSvgCartesian(
                d3.scaleLog(),
                d3.scaleLinear()
              )
      .xDomain(fc.extentLinear()
        .accessors([<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.income; }])(data))
      .yDomain(fc.extentLinear()
        .accessors([<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.lifeExpectancy; }])(data))
      .chartLabel(<span class="hljs-string">'The Wealth &amp; Health of Nations'</span>)
      .xLabel(<span class="hljs-string">'Income (dollars)'</span>)
      .yLabel(<span class="hljs-string">'Life expectancy (years)'</span>)
      .xTicks(<span class="hljs-number">2</span>, d3.format(<span class="hljs-string">',d'</span>))
      .yOrient(<span class="hljs-string">'left'</span>)
      .plotArea(pointSeries)
      .decorate(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">selection</span>) </span>{
        <span class="hljs-comment">// append an svg for the d3-legend</span>
        selection.enter()
          .append(<span class="hljs-string">'svg'</span>)
          .attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'legend'</span>);

        <span class="hljs-comment">// render the legend</span>
        selection.select(<span class="hljs-string">'.legend'</span>)
          .call(legend);
      });

  d3.select(<span class="hljs-string">'#bubble-chart'</span>)
      <span class="hljs-comment">// remove the loading text from the container</span>
      .text(<span class="hljs-literal">null</span>)
      .datum(data)
      .call(chart);
});
</code></pre>

    </div>

    <nav class="col-sm-3 hidden-xs nav-container">
      <ul class="nav nav-stacked fixed nav-sidebar">
            <li>
                <span  class="active">Bubble Chart</span>
            </li>
            <li>
                <a href="/examples/simple/index.html">Line / Area Chart</a>
            </li>
            <li>
                <a href="/examples/stacked/index.html">Stacked Bar</a>
            </li>
            <li>
                <a href="/examples/streaming/index.html">Streaming Financial Chart</a>
            </li>
            <li>
                <a href="/examples/zoom/index.html">Canvas Chart Zoom</a>
            </li>
      </ul>
    </nav>
</div>


    </div>
    <footer>
      <div class="container">
        <p class="muted credit text-center">Project supported by <a href="http://www.scottlogic.com">Scott Logic</a>.</p>
      </div>
    </footer>
  </body>
</html>
